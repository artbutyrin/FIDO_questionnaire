# Task 10: Quotes Application Backend

Цей проєкт є бекенд-застосунком на Java з використанням фреймворку Spring Boot, який дозволяє користувачам ділитися цитатами, а також переглядати, редагувати та видаляти їх.

## Зміст

- [Огляд Проєкту](#огляд-проєкту)
- [Функціонал API](#функціонал-api)
- [Використані Технології](#використані-технології)
- [Вимоги](#вимоги)
- [Налаштування та Запуск](#налаштування-та-запуск)
- [Використання API](#використання-api)
- [Доступ до H2 Console](#доступ-до-h2-console-опціонально)

## Огляд Проєкту

Застосунок реалізує RESTful API для керування цитатами. Дані зберігаються у вбудованій базі даних H2, що забезпечує їх збереження між перезапусками сервера. Вхідні дані валідуються для забезпечення коректності та дотримання обмежень на довжину та порожність полів `author` та `text`.

## Функціонал API

Наступні ендпоінти реалізовано:

### 1. Створення цитати

- **Метод**: `POST`
- **Шлях**: `/quotes`
- **Опис**: Приймає JSON з полями "author" та "text"
- **Приймає**: `application/json`

```json
{
    "author": "Ім'я Автора",
    "text": "Текст цитати"
}
```

**Повертає**: `201 Created` з id створеної цитати або `400 Bad Request` у випадку помилки валідації

```json
{"id": 1}
```

### 2. Відображення цитат

#### Отримання цитати за ID

- **Метод**: `GET`
- **Шлях**: `/quotes/{id}`
- **Опис**: Повертає цитату за її ID
- **Повертає**: `200 OK` з JSON-об'єктом цитати або `404 Not Found`, якщо цитату не знайдено

```json
{"id": 1, "author": "Ім'я Автора", "text": "Текст цитати"}
```

#### Отримання колекції цитат з фільтрацією та пагінацією

- **Метод**: `GET`
- **Шлях**: `/quotes`
- **Опис**: Повертає колекцію цитат. Можлива фільтрація за автором та пагінація

**Параметри запиту**:
- `author` (необов'язково): фільтрує цитати за автором (пошук відбувається без урахування регістру, містить)
- `page` (необов'язково, за замовчуванням 0): номер сторінки
- `size` (необов'язково, за замовчуванням 10): кількість елементів на сторінці

**Приклад URL**:
- `/quotes` (всі цитати)
- `/quotes?author=Ім'я` (фільтрація за автором)
- `/quotes?page=1&size=5` (пагінація)

**Повертає**: `200 OK` з об'єктом Page (Spring Data Page), що містить список цитат та метадані пагінації

### 3. Редагування цитати

- **Метод**: `PUT`
- **Шлях**: `/quotes/{id}`
- **Опис**: Оновлює автора та текст цитати за ID
- **Приймає**: `application/json` з полями "author" та "text"
- **Повертає**: `200 OK` з оновленою цитатою, `404 Not Found` якщо цитату не знайдено, або `400 Bad Request` у випадку помилки валідації

### 4. Видалення цитати

- **Метод**: `DELETE`
- **Шлях**: `/quotes/{id}`
- **Опис**: Видаляє цитату за ID
- **Повертає**: `204 No Content` у випадку успішного видалення або `404 Not Found`, якщо цитату не знайдено

### Обмеження на цитату

- `author`: не порожній та не довший ніж 200 символів
- `text`: не порожній та не довший ніж 1000 символів

## Використані Технології

- **Java** 17+
- **Spring Boot** 3.2.0
- **Spring Data JPA**
- **Hibernate**
- **H2 Database** (вбудована файлова база даних для персистентності)
- **Maven** (система збирання проєкту)
- **Jakarta Validation**

## Вимоги

Для запуску та роботи з цим проєктом вам знадобиться:

1. **Java Development Kit (JDK)** 
   - [Завантажити JDK](https://www.oracle.com/java/technologies/downloads/) 

2. **Apache Maven**
   - [Завантажити Maven](https://maven.apache.org/download.cgi) 

3. **IDE** 
   - Рекомендовано **Visual Studio Code** 

## Налаштування та Запуск

### Запуск застосунку

Відкрийте термінал у VS Code (`Terminal -> New Terminal`) і виконайте команду:

```bash
mvn spring-boot:run
```

Перший запуск може зайняти деякий час, оскільки Maven завантажуватиме всі необхідні залежності. Коли застосунок буде успішно запущений, з'явиться повідомлення, що Tomcat стартував на порту 8080.

**Залиште цей термінал відкритим**, оскільки застосунок буде працювати у фоновому режимі.

## Використання API

Після запуску застосунку, ви можете використовувати інструменти, такі як `curl` (у терміналі) або графічні клієнти, як **Postman**, для тестування API. Особисто я користувався **Postman**, адже так набагато зручніше.

**Сервер працює за адресою**: `http://localhost:8080`

### Приклади використання за допомогою curl (у новому терміналі):

#### Створити цитату (POST)

```bash
curl -X POST -H "Content-Type: application/json" -d '{"author": "Леся Українка", "text": "Без надії таки сподіватись!"}' http://localhost:8080/quotes
```

**Очікувана відповідь**: `{"id":1}`

#### Отримати цитату за ID (GET)

```bash
curl http://localhost:8080/quotes/1
```

**Очікувана відповідь**: `{"id":1,"author":"Леся Українка","text":"Без надії таки сподіватись!"}`

#### Отримати всі цитати (GET)

```bash
curl http://localhost:8080/quotes
```

**Очікувана відповідь**: Список цитат з пагінацією

#### Отримати цитати з фільтрацією за автором (GET)

```bash
curl "http://localhost:8080/quotes?author=Леся"
```

**Очікувана відповідь**: Список цитат, де автор містить "Леся"

#### Оновити цитату (PUT)

```bash
curl -X PUT -H "Content-Type: application/json" -d '{"author": "Леся Українка", "text": "Ні, я жива! Я буду вічно жити! Я в серці маю те, що не вмирає!"}' http://localhost:8080/quotes/1
```

**Очікувана відповідь**: Оновлена цитата

#### Видалити цитату (DELETE)

```bash
curl -X DELETE http://localhost:8080/quotes/1
```

**Очікувана відповідь**: Порожня відповідь зі статусом `204 No Content`

### Використання Postman:

1. Відкрийте Postman
2. Створіть новий запит
3. Виберіть метод (POST, GET, PUT, DELETE)
4. Введіть URL (наприклад, `http://localhost:8080/quotes`)
5. Для POST та PUT запитів перейдіть на вкладку Headers і додайте `Content-Type: application/json`
6. Для POST та PUT запитів перейдіть на вкладку Body, виберіть raw та JSON формат, і вставте відповідне JSON-тіло
7. Натисніть Send

## Доступ до H2 Console (Опціонально)

Для перегляду даних у базі даних H2 ви можете використати веб-консоль:

1. Переконайтеся, що застосунок запущено
2. Відкрийте у браузері: `http://localhost:8080/h2-console`
3. Введіть наступні дані:
   - **Driver Class**: `org.h2.Driver`
   - **JDBC URL**: `jdbc:h2:file:./data/quotes`
   - **User Name**: `sa`
   - **Password**: (залиште порожнім)
4. Натисніть "Connect"

Ви зможете переглядати таблицю `QUOTES` та виконувати SQL-запити.

---

## Структура проєкту

```
src/
├── main/
│   ├── java/com/quotes/app/
│   │   ├── QuotesApplication.java          # Головний клас Spring Boot
│   │   ├── controller/
│   │   │   └── QuoteController.java        # REST контролер
│   │   ├── entity/
│   │   │   └── Quote.java                  # JPA сутність
│   │   ├── exception/
│   │   │   └── GlobalExceptionHandler.java # Обробка винятків
│   │   ├── repository/
│   │   │   └── QuoteRepository.java        # JPA репозиторій
│   │   └── service/
│   │       └── QuoteService.java           # Сервісний шар
│   └── resources/
│       └── application.properties          # Конфігурація Spring Boot
└── pom.xml                                 # Maven конфігурація
```